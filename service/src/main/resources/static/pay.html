<!--
  ~ Copyright 2019 IntraFind Software AG. All rights reserved.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!DOCTYPE html>

<html lang="en">
<meta charset="utf-8"/>
<title>Pay | Site Search</title>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://bridge.paymill.com/"></script>


<script>
    const PAYMILL_PUBLIC_KEY = "97857955705f5b46ae9532d455169b26";

    var payFrameCallback = function (error) {
        if (error) {
            console.error(error.apierror, error.message);
        } else {
            console.log("PayFrame successfully loaded");
            $("#payment-form").show(100);
        }
    };


    const submit = function (event) {
        paymill.createTokenViaFrame({
            amount_int: 4312,
            currency: 'EUR'
        }, function (error, result) {
            if (error) {
                console.error(error.apierror, error.message);
            } else {
                console.warn("token: " + result.token);
            }
        });

        return false;
    };


    setTimeout(function () {
        paymill.embedFrame("credit-card-fields", {
            lang: "en"
        }, payFrameCallback);
        $("#payment-form").submit(submit);
    }, 0);
</script>


<form action="#" id="payment-form" method="POST" style="padding: 20px">
    <input name="amount" type="hidden" value="4211">
    <input name="currency" type="hidden" value="EUR">
    <input name="description" type="hidden" value="Easy Payments Guide!!!">

    <div id="credit-card-fields"></div>

    <button style="width: 500px" type="submit">Pay</button>
</form>

<!--
4111111111111111

curl https://api.paymill.com/v2.1/clients \
        -u 3c0c3f2119d888b28f0ad518b859a5c4: \
        -d "email=sis-client@example.com" \
        -d "description=SiS Test Client"

curl https://api.paymill.com/v2.1/payments \
        -u 3c0c3f2119d888b28f0ad518b859a5c4: \
        -d "token=tok_bc4dad500ce004067bd043af293c" \
        -d "client=client_6ca121616b24a290a2b0"

curl https://api.paymill.com/v2.1/preauthorizations \
        -u 3c0c3f2119d888b28f0ad518b859a5c4: \
        -d "payment=pay_f62ba7737ba07ae9f3277d9d" \
        -d "amount=4200" \
        -d "currency=EUR"

curl https://api.paymill.com/v2.1/transactions \
        -u 3c0c3f2119d888b28f0ad518b859a5c4: \
        -d "amount=4200" \
        -d "currency=EUR" \
        -d "payment=pay_f62ba7737ba07ae9f3277d9d" \
        -d "description=Test Transaction"

curl https://api.paymill.com/v2.1/transactions \
        -u 3c0c3f2119d888b28f0ad518b859a5c4: \
        -d "amount=4200" \
        -d "currency=EUR" \
        -d "client=client_6ca121616b24a290a2b0" \
        -d "payment=pay_ffa0b8392e8cff8c4e8f99eb" \
        -d "description=Test Transaction 123"

-->


